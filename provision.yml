parameters:
- name: subscriptionName
  type: string
- name: location
  type: string
- name: stage
  type: string
 
steps:
- task: AzureCLI@2
  displayName: Set subscription
  inputs:
    scriptType: 'bash'
    scriptLocation: 'inlineScript'
    inlineScript: |
      az account set --subscription ${{ parameters.subscriptionName }}
 
- task: AzureCLI@2
  variables:
    resourceGroupName: 'Moo-RG-${{ parameters.stage }}'
    tagPlatform: 'Moo Integration'
    tagSubPlatform: 'Integration'
    tagDataClassification: 'moo-confidential'
    tagBusinessCriticality: 'business-supporting'
    tagPcode: 'P_000404'
    team: 'Nexus'
    tagStage: '{{ parameters.stage }}'
  displayName: Create resource group
  inputs:
    scriptType: 'bash'
    scriptLocation: 'inlineScript'
    inlineScript: |
      az group create \
      --name $(resourceGroupName) \
      --location $(location) \
      --tags platform='$(tagPlatform)' \
        sub-platform='$(tagSubPlatform)' \
        stage=$(tagStage) \
        data-classification=$(tagDataClassification) \
        business-criticality=$(tagBusinessCriticality) \
        pcode=$(pcode) \
        team=$(team)