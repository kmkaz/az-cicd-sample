trigger:
  - ci-cd/initial-pipeline

pool:
  vmImage: ubuntu-latest

variables:
  nonProdSubName: 'Visual Studio Premium with MSDN'
  prodSubName: 'Visual Studio Premium with MSDN'
  tagPlatform: 'Moo Integration'
  tagSubPlatform: 'Integration'
  tagDataClassification: 'moo-confidential'
  tagBusinessCriticality: 'business-supporting'
  tagPcode: 'P_000404'
  team: 'Nexus'

stages:
- stage: 'DEV_EUN'
  jobs:
  - job: DevDeploy
    displayName: Deploy to DEV
    variables:
      tagStage: 'Dev'
      location: 'northeurope'
      resourceGroupName: 'Moo-RG-$(tagStage)'
    steps:
    - task: AzureCLI@2
      displayName: Set subscription
      inputs:
        scriptType: 'bash'
        scriptLocation: 'inlineScript'
        inlineScript: |
          az account set --subscription ${{ parameters.subscriptionName }}
    - task: AzureCLI@2
      displayName: Create resource group
      inputs:
        scriptType: 'bash'
        scriptLocation: 'inlineScript'
        inlineScript: |
          az group create \
          --name $(resourceGroupName) \
          --location $(location) \
          --tags platform='$(tagPlatform)' \
            sub-platform='$(tagSubPlatform)' \
            stage=$(tagStage) \
            data-classification=$(tagDataClassification) \
            business-criticality=$(tagBusinessCriticality) \
            pcode=$(pcode) \
            team=$(team)
